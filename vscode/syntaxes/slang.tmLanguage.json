{
    "scopeName": "source.slang",
    "patterns": [{
        "include": "#fragment"
    }, {
        "include": "#entrypoint"
    }, {
        "include": "#line-comment"
    }, {
        "include": "#block-comment"
    }],
    "repository": {
        "line-comment": {
            "begin": "//",
            "end": "$",
            "name": "comment.line.c"
        },

        "block-comment": {
            "begin": "/\\*",
            "end": "\\*/",
            "name": "comment.block.c"
        },

        "fragment": {
            "begin": "(fragment)\\s+([a-zA-Z0-9-_]+)\\s*(\\{)",
            "end": "\\}",
            "beginCaptures": {
                "1": {
                    "name": "keyword.control"
                },
                "2": {
                    "name": "other"
                },
                "3": {
                    "name": "punctuation.brace.open"
                }
            },
            "endCaptures": {
                "0": {
                    "name": "punctuation.brace.close"
                }
            },
            "patterns": [{
                "include": "#expression"
            }]
        },

        "entrypoint": {
            "begin": "(@[a-zA-Z0-9-_]+)\\s*(\\{)",
            "end": "\\}",
            "beginCaptures": {
                "1": {
                    "name": "keyword.control"
                },
                "2": {
                    "name": "puncutation.brace.open"
                }
            },
            "endCaptures": {
                "0": {
                    "name": "puncutation.brace.close"
                }
            },
            "patterns": [{
                "include": "#expression"
            }]
        },

        "grant": {
            "match": "([a-zA-Z0-9-_\\.]+)(;)",
            "captures": {
                "1": {
                    "name": "string"
                },
                "2": {
                    "name": "punctuation.terminator"
                }
            }
        },

        "include-fragment": {
            "match": "(#[a-zA-Z0-9-_]+)(;)",
            "captures": {
                "1": {
                    "name": "entity.name.fragment"
                },
                "2": {
                    "name": "punctuation.terminator"
                }
            }
        },

        "rule": {
            "begin": "[a-zA-Z0-9-_]+\\s*(?![a-zA-Z0-9-_\\.;])",
            "end": "(?={)",
            "name": "other",
            "patterns": [{
                "include": "#attribute"
            }]
        },

        "attribute": {
            "patterns": [{
                    "include": "#attribute-noarg"
                },
                {
                    "include": "#attribute-arg"
                }
            ]
        },

        "attribute-noarg": {
            "match": "(:[a-zA-Z0-9-_]+)\\s*(?![a-zA-Z0-9-_\\(])",
            "name": "entity.other.attribute-name"
        },

        "attribute-arg": {
            "begin": "(:[a-zA-Z0-9-_]+)(\\()",
            "end": "(\\))",
            "beginCaptures": {
                "1": {
                    "name": "entity.other.attribute-name"
                },
                "2": {
                    "name": "punctuation.paren.open"
                }
            },
            "endCaptures": {
                "1": {
                    "name": "punctuation.paren.close"
                }
            },
            "patterns": [{
                "include": "#attribute-argument"
            }]
        },

        "attribute-argument": {
            "match": "([a-zA-Z0-9-_]+)",
            "name": "support.type.property-name"
        },

        "rule-group": {
            "begin": "\\{",
            "end": "\\}",
            "beginCaptures": {
                "0": {
                    "name": "punctuation.brace.open"
                }
            },
            "endCaptures": {
                "0": {
                    "name": "punctuation.brace.close"
                }
            },
            "patterns": [{
                "include": "#expression"
            }]
        },

        "universal": {
            "match": "(\\*)",
            "name": "keyword.control"
        },

        "expression": {
            "patterns": [{
                    "include": "#rule"
                },
                {
                    "include": "#rule-group"
                },
                {
                    "include": "#universal"
                },
                {
                    "include": "#grant"
                },
                {
                    "include": "#include-fragment"
                },
                {
                    "include": "#line-comment"
                },
                {
                    "include": "#block-comment"
                }
            ]
        }
    }
}